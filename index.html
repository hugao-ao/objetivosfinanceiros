<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnóstico Financeiro Online</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #0a1f1a; /* Verde escuro para fundo */
            color: #e6e6e6; /* Texto claro */
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #0e2922; /* Verde esmeralda escuro */
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            border: 1px solid #1a5a4c; /* Borda verde mais clara */
        }
        h1, h2, h3 {
            color: #d4af37; /* Dourado */
            margin-bottom: 20px;
        }
        h1 {
            text-align: center;
            font-size: 2.2em;
            margin-bottom: 30px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        h2 {
            margin-top: 30px;
            border-bottom: 2px solid #1a5a4c; /* Verde esmeralda médio */
            padding-bottom: 10px;
            font-size: 1.6em;
        }
        h3 {
            color: #c5a028; /* Dourado mais escuro */
            font-size: 1.3em;
            margin-top: 25px;
        }
        fieldset {
            border: 1px solid #1a5a4c; /* Verde esmeralda médio */
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 25px;
            background-color: #0c2420; /* Verde esmeralda muito escuro */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        legend {
            font-weight: bold;
            color: #d4af37; /* Dourado */
            padding: 0 10px;
            font-size: 1.2em;
            background-color: #0e2922; /* Verde esmeralda escuro */
            border: 1px solid #1a5a4c; /* Verde esmeralda médio */
            border-radius: 4px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #b8e0d8; /* Verde claro para labels */
        }
        input[type="text"],
        input[type="number"],
        input[type="date"],
        input[type="email"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #1a5a4c; /* Verde esmeralda médio */
            border-radius: 4px;
            box-sizing: border-box;
            font-family: inherit;
            font-size: 1em;
            transition: border-color 0.3s;
            background-color: #0a1f1a; /* Verde escuro */
            color: #e6e6e6; /* Texto claro */
        }
        input:focus, select:focus, textarea:focus {
            border-color: #d4af37; /* Dourado */
            outline: none;
            box-shadow: 0 0 5px rgba(212, 175, 55, 0.5); /* Sombra dourada */
        }
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        input[type="radio"],
        input[type="checkbox"] {
            margin-right: 5px;
            accent-color: #d4af37; /* Dourado para os checkboxes/radio */
        }
        .radio-group label,
        .checkbox-group label {
            font-weight: normal;
            display: inline-block;
            margin-right: 15px;
            margin-bottom: 10px;
            color: #c5e0da; /* Verde claro para texto */
        }

        .form-group {
            margin-bottom: 20px;
        }

        .button-container {
            text-align: center;
            margin-top: 30px;
        }

        button {
            background-color: #1a5a4c; /* Verde esmeralda médio */
            color: #d4af37; /* Dourado */
            padding: 12px 25px;
            border: 1px solid #d4af37; /* Borda dourada */
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 0 10px;
        }
        button:hover {
            background-color: #d4af37; /* Dourado */
            color: #0e2922; /* Verde escuro */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        button.secondary {
            background-color: #0e2922; /* Verde escuro */
            color: #d4af37; /* Dourado */
        }
        button.secondary:hover {
            background-color: #c5a028; /* Dourado mais escuro */
            color: #0e2922; /* Verde escuro */
        }

        .analysis-section {
            margin-top: 30px;
            padding: 25px;
            border: 1px solid #1a5a4c; /* Verde esmeralda médio */
            border-radius: 5px;
            background-color: #0c2420; /* Verde esmeralda muito escuro */
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }
        .analysis-section h3 {
            margin-top: 0;
            color: #d4af37; /* Dourado */
        }
        .editable-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid #1a5a4c; /* Verde esmeralda médio */
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 10px;
            font-family: inherit;
            background-color: #0a1f1a; /* Verde escuro */
            color: #e6e6e6; /* Texto claro */
        }
        
        .progress-bar {
            width: 100%;
            background-color: #0a1f1a; /* Verde escuro */
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
            border: 1px solid #1a5a4c; /* Verde esmeralda médio */
        }
        
        .progress {
            height: 10px;
            background-color: #d4af37; /* Dourado */
            width: 0%;
            transition: width 0.5s ease-in-out;
        }
        
        .tab {
            display: none;
        }
        
        .tab.active {
            display: block;
        }
        
        .tab-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .positive {
            color: #8fd14f; /* Verde claro */
            font-weight: bold;
        }
        
        .negative {
            color: #e74c3c; /* Vermelho */
            font-weight: bold;
        }
        
        .neutral {
            color: #d4af37; /* Dourado */
            font-weight: bold;
        }
        
        .result-card {
            background-color: #0c2420; /* Verde esmeralda muito escuro */
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            border: 1px solid #1a5a4c; /* Verde esmeralda médio */
        }
        
        .result-card h4 {
            margin-top: 0;
            color: #d4af37; /* Dourado */
            border-bottom: 1px solid #1a5a4c; /* Verde esmeralda médio */
            padding-bottom: 10px;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            margin-left: 5px;
            color: #d4af37; /* Dourado */
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #0a1f1a; /* Verde escuro */
            color: #e6e6e6; /* Texto claro */
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: normal;
            font-size: 0.9em;
            border: 1px solid #d4af37; /* Borda dourada */
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            h1 {
                font-size: 1.8em;
            }
            button {
                width: 100%;
                margin: 10px 0;
            }
            .tab-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Diagnóstico Financeiro Online</h1>
        
        <div class="progress-bar">
            <div id="progress" class="progress"></div>
        </div>

        <form id="diagnosticoForm">
            <!-- Tabs para organizar o formulário -->
            <div id="tab1" class="tab active">
                <!-- 1. Introdução e Boas-vindas -->
                <fieldset>
                    <legend>Bem-vindo(a)!</legend>
                    <p>Este diagnóstico tem como objetivo ajudar você a entender melhor sua situação financeira atual e identificar pontos de melhoria. Ao preencher as informações a seguir, você terá uma visão clara do seu patrimônio, fluxo de caixa, riscos e planejamento para o futuro.</p>
                    <p>O preenchimento leva aproximadamente <strong>15-20 minutos</strong>.</p>
                    <p><strong>Privacidade:</strong> Suas informações são confidenciais e serão usadas apenas para gerar seu diagnóstico pessoal neste navegador. Nenhum dado será salvo externamente sem sua permissão.</p>
                </fieldset>

                <!-- 2. Dados Pessoais -->
                <fieldset>
                    <legend>Dados Pessoais</legend>
                    <div class="form-group">
                        <label for="nome">Nome Completo:</label>
                        <input type="text" id="nome" name="nome">
                    </div>
                    <div class="form-group">
                        <label for="nascimento">Data de Nascimento:</label>
                        <input type="date" id="nascimento" name="nascimento">
                    </div>
                    <div class="form-group">
                        <label for="estadoCivil">Estado Civil:</label>
                        <select id="estadoCivil" name="estadoCivil">
                            <option value="">Selecione...</option>
                            <option value="solteiro">Solteiro(a)</option>
                            <option value="casado">Casado(a)</option>
                            <option value="uniao_estavel">União Estável</option>
                            <option value="divorciado">Divorciado(a)</option>
                            <option value="viuvo">Viúvo(a)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dependentes">Número de Dependentes:</label>
                        <input type="number" id="dependentes" name="dependentes" min="0" value="0">
                    </div>
                    <div class="form-group">
                        <label for="profissao">Profissão/Ocupação Principal:</label>
                        <input type="text" id="profissao" name="profissao">
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <div></div>
                    <button type="button" onclick="nextTab(1, 2)">Próximo</button>
                </div>
            </div>

            <div id="tab2" class="tab">
                <!-- 3. Objetivos Financeiros -->
                <fieldset>
                    <legend>Objetivos Financeiros</legend>
                    <div class="form-group">
                        <label for="objetivoPrincipal">Qual seu principal objetivo financeiro hoje?</label>
                        <textarea id="objetivoPrincipal" name="objetivoPrincipal" placeholder="Ex: Comprar uma casa, Aposentadoria tranquila, Viajar o mundo, Pagar dívidas..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="objetivoImportancia">Por que este objetivo é importante para você?</label>
                        <textarea id="objetivoImportancia" name="objetivoImportancia"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="objetivoPrazo">Em quanto tempo você gostaria de atingir este objetivo (em anos)?</label>
                        <input type="number" id="objetivoPrazo" name="objetivoPrazo" min="0" step="0.5">
                    </div>
                     <div class="form-group">
                        <label for="objetivoCusto">Quanto você estima que este objetivo custa (R$)?</label>
                        <input type="number" id="objetivoCusto" name="objetivoCusto" min="0" step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="objetivoEstrategia">Qual sua estratégia atual para atingir este objetivo?</label>
                        <textarea id="objetivoEstrategia" name="objetivoEstrategia" placeholder="Ex: Poupança mensal, Investimentos específicos, Renda extra..."></textarea>
                    </div>
                     <div class="form-group">
                        <label for="objetivoProgresso">Quanto você já acumulou para este objetivo (em %)?</label>
                        <input type="number" id="objetivoProgresso" name="objetivoProgresso" min="0" max="100" step="1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="objetivosSecundarios">Você tem outros objetivos financeiros importantes?</label>
                        <textarea id="objetivosSecundarios" name="objetivosSecundarios" placeholder="Liste outros objetivos, se houver."></textarea>
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(2, 1)">Anterior</button>
                    <button type="button" onclick="nextTab(2, 3)">Próximo</button>
                </div>
            </div>

            <div id="tab3" class="tab">
                <!-- 4. Fluxo de Caixa -->
                <fieldset>
                    <legend>Fluxo de Caixa Mensal</legend>
                    <p>Informe os valores médios mensais.</p>
                    <h3>Receitas</h3>
                    <div class="form-group">
                        <label for="receitaSalario">Salário Líquido / Pró-labore (R$):</label>
                        <input type="number" id="receitaSalario" name="receitaSalario" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                    <div class="form-group">
                        <label for="receitaAlugueis">Receita de Aluguéis (R$):</label>
                        <input type="number" id="receitaAlugueis" name="receitaAlugueis" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                    <div class="form-group">
                        <label for="receitaDividendos">Dividendos / Juros sobre Capital Próprio (R$):</label>
                        <input type="number" id="receitaDividendos" name="receitaDividendos" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="receitaOutras">Outras Receitas Recorrentes (R$):</label>
                        <input type="number" id="receitaOutras" name="receitaOutras" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>

                    <h3>Despesas Fixas</h3>
                     <div class="form-group">
                        <label for="despesaMoradia">Moradia (Aluguel/Financiamento, Condomínio, IPTU) (R$):</label>
                        <input type="number" id="despesaMoradia" name="despesaMoradia" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                    <div class="form-group">
                        <label for="despesaEducacao">Educação (Mensalidades, Cursos) (R$):</label>
                        <input type="number" id="despesaEducacao" name="despesaEducacao" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                    <div class="form-group">
                        <label for="despesaSaude">Saúde (Plano, Medicamentos recorrentes) (R$):</label>
                        <input type="number" id="despesaSaude" name="despesaSaude" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                    <div class="form-group">
                        <label for="despesaTransporte">Transporte (Combustível, Passagens, Financiamento/Seguro Auto) (R$):</label>
                        <input type="number" id="despesaTransporte" name="despesaTransporte" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="despesaAlimentacaoFixa">Alimentação (Supermercado, Feira) (R$):</label>
                        <input type="number" id="despesaAlimentacaoFixa" name="despesaAlimentacaoFixa" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="despesaServicosBasicos">Serviços Básicos (Água, Luz, Gás, Internet, Telefone) (R$):</label>
                        <input type="number" id="despesaServicosBasicos" name="despesaServicosBasicos" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="despesaOutrasFixas">Outras Despesas Fixas (Assinaturas, Academia, etc.) (R$):</label>
                        <input type="number" id="despesaOutrasFixas" name="despesaOutrasFixas" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>

                    <h3>Despesas Variáveis</h3>
                     <div class="form-group">
                        <label for="despesaLazer">Lazer (Restaurantes, Cinema, Shows, etc.) (R$):</label>
                        <input type="number" id="despesaLazer" name="despesaLazer" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="despesaVestuario">Vestuário e Cuidados Pessoais (R$):</label>
                        <input type="number" id="despesaVestuario" name="despesaVestuario" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="despesaPresentes">Presentes e Doações (R$):</label>
                        <input type="number" id="despesaPresentes" name="despesaPresentes" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="despesaViagens">Viagens (R$):</label>
                        <input type="number" id="despesaViagens" name="despesaViagens" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>
                     <div class="form-group">
                        <label for="despesaOutrasVariaveis">Outras Despesas Variáveis (R$):</label>
                        <input type="number" id="despesaOutrasVariaveis" name="despesaOutrasVariaveis" min="0" step="0.01" placeholder="0.00" onchange="calcularSaldo()">
                    </div>

                    <h3>Saldo Mensal</h3>
                    <div class="form-group">
                        <label>Saldo Mensal Estimado (Receitas - Despesas) (R$):</label>
                        <input type="text" id="saldoMensal" name="saldoMensal" readonly style="background-color: #0a1f1a; font-weight: bold; border: 1px solid #d4af37;">
                    </div>
                     <div class="form-group">
                        <label for="periodoAnalise">Período de Análise Preferencial:</label>
                        <select id="periodoAnalise" name="periodoAnalise">
                            <option value="mensal" selected>Mensal</option>
                            <option value="anual">Anual</option>
                            <option value="personalizado">Personalizado</option>
                        </select>
                        <input type="text" id="periodoPersonalizado" name="periodoPersonalizado" placeholder="Descreva o período personalizado" style="display: none; margin-top: 10px;">
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(3, 2)">Anterior</button>
                    <button type="button" onclick="nextTab(3, 4)">Próximo</button>
                </div>
            </div>

            <div id="tab4" class="tab">
                <!-- 5. Contas Correntes e Cartões de Crédito -->
                <fieldset>
                    <legend>Contas Correntes e Cartões</legend>
                    <h3>Contas Correntes</h3>
                    <div class="form-group">
                        <label for="contasQuantidade">Quantas contas correntes ativas você possui?</label>
                        <input type="number" id="contasQuantidade" name="contasQuantidade" min="0" value="1">
                    </div>
                    <div class="form-group">
                        <label for="contasBancos">Principais bancos onde possui conta:</label>
                        <input type="text" id="contasBancos" name="contasBancos" placeholder="Ex: Banco A, Banco B">
                    </div>
                    <div class="form-group">
                        <label for="contasTarifas">Gasto mensal estimado com tarifas bancárias (R$):</label>
                        <input type="number" id="contasTarifas" name="contasTarifas" min="0" step="0.01" placeholder="0.00">
                    </div>

                    <h3>Cartões de Crédito</h3>
                    <div class="form-group">
                        <label for="cartoesQuantidade">Quantos cartões de crédito ativos você utiliza?</label>
                        <input type="number" id="cartoesQuantidade" name="cartoesQuantidade" min="0" value="1">
                    </div>
                    <div class="form-group">
                        <label for="cartoesBandeiras">Principais bandeiras dos cartões:</label>
                        <input type="text" id="cartoesBandeiras" name="cartoesBandeiras" placeholder="Ex: Visa, Mastercard">
                    </div>
                    <div class="form-group">
                        <label for="cartoesAnuidades">Gasto anual estimado com anuidades de cartão (R$):</label>
                        <input type="number" id="cartoesAnuidades" name="cartoesAnuidades" min="0" step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Você utiliza programas de recompensa (milhas, cashback)?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="cartoesRecompensaUso" value="sim"> Sim</label>
                            <label><input type="radio" name="cartoesRecompensaUso" value="nao" checked> Não</label>
                            <label><input type="radio" name="cartoesRecompensaUso" value="parcialmente"> Parcialmente</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="cartoesBeneficios">Quais benefícios você mais valoriza/utiliza?</label>
                        <textarea id="cartoesBeneficios" name="cartoesBeneficios" placeholder="Ex: Milhas aéreas, Cashback, Descontos, Acesso a salas VIP..."></textarea>
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(4, 3)">Anterior</button>
                    <button type="button" onclick="nextTab(4, 5)">Próximo</button>
                </div>
            </div>

            <div id="tab5" class="tab">
                <!-- 6. Patrimônio Físico -->
                <fieldset>
                    <legend>Patrimônio Físico</legend>
                    <h3>Imóveis</h3>
                    <div class="form-group">
                        <label for="imoveisValor">Valor estimado total dos seus imóveis (R$):</label>
                        <input type="number" id="imoveisValor" name="imoveisValor" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>
                     <div class="form-group">
                        <label>Situação dos imóveis:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="imoveisSituacao" value="quitado"> Quitado(s)</label>
                            <label><input type="checkbox" name="imoveisSituacao" value="financiado"> Financiado(s)</label>
                            <label><input type="checkbox" name="imoveisSituacao" value="heranca"> Herança</label>
                        </div>
                    </div>

                    <h3>Veículos</h3>
                    <div class="form-group">
                        <label for="veiculosValor">Valor estimado total dos seus veículos (carros, motos, etc.) (R$):</label>
                        <input type="number" id="veiculosValor" name="veiculosValor" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>
                     <div class="form-group">
                        <label>Situação dos veículos:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="veiculosSituacao" value="quitado"> Quitado(s)</label>
                            <label><input type="checkbox" name="veiculosSituacao" value="financiado"> Financiado(s)</label>
                            <label><input type="checkbox" name="veiculosSituacao" value="consorcio"> Consórcio</label>
                        </div>
                    </div>

                    <h3>Outros Bens</h3>
                     <div class="form-group">
                        <label for="outrosBensValor">Valor estimado de outros bens de valor (joias, arte, coleções) (R$):</label>
                        <input type="number" id="outrosBensValor" name="outrosBensValor" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(5, 4)">Anterior</button>
                    <button type="button" onclick="nextTab(5, 6)">Próximo</button>
                </div>
            </div>

            <div id="tab6" class="tab">
                <!-- 7. Dívidas e Obrigações -->
                <fieldset>
                    <legend>Dívidas e Obrigações</legend>
                    <h3>Financiamentos (Imobiliário, Veículo, etc.)</h3>
                    <div class="form-group">
                        <label for="financiamentoSaldo">Saldo devedor total de financiamentos (R$):</label>
                        <input type="number" id="financiamentoSaldo" name="financiamentoSaldo" min="0" step="0.01" placeholder="0.00" onchange="calcularDividaTotal()">
                    </div>
                    <div class="form-group">
                        <label for="financiamentoParcela">Valor total das parcelas mensais de financiamentos (R$):</label>
                        <input type="number" id="financiamentoParcela" name="financiamentoParcela" min="0" step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="financiamentoTaxaMedia">Taxa de juros média anual dos financiamentos (%):</label>
                        <input type="number" id="financiamentoTaxaMedia" name="financiamentoTaxaMedia" min="0" step="0.01" placeholder="0.00">
                    </div>

                    <h3>Empréstimos (Pessoal, Consignado, etc.)</h3>
                     <div class="form-group">
                        <label for="emprestimoSaldo">Saldo devedor total de empréstimos (R$):</label>
                        <input type="number" id="emprestimoSaldo" name="emprestimoSaldo" min="0" step="0.01" placeholder="0.00" onchange="calcularDividaTotal()">
                    </div>
                    <div class="form-group">
                        <label for="emprestimoParcela">Valor total das parcelas mensais de empréstimos (R$):</label>
                        <input type="number" id="emprestimoParcela" name="emprestimoParcela" min="0" step="0.01" placeholder="0.00">
                    </div>
                     <div class="form-group">
                        <label for="emprestimoTaxaMedia">Taxa de juros média anual dos empréstimos (%):</label>
                        <input type="number" id="emprestimoTaxaMedia" name="emprestimoTaxaMedia" min="0" step="0.01" placeholder="0.00">
                    </div>

                    <h3>Cartão de Crédito</h3>
                    <div class="form-group">
                        <label>Você costuma pagar o valor total da fatura do cartão de crédito?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="cartaoPagamentoTotal" value="sim" checked> Sim, sempre</label>
                            <label><input type="radio" name="cartaoPagamentoTotal" value="parcial"> Não, às vezes pago o mínimo ou parcelo</label>
                            <label><input type="radio" name="cartaoPagamentoTotal" value="nao_usa"> Não utilizo cartão de crédito</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="cartaoSaldoRotativo">Você possui saldo devedor no rotativo do cartão (R$)?</label>
                        <input type="number" id="cartaoSaldoRotativo" name="cartaoSaldoRotativo" min="0" step="0.01" placeholder="0.00" onchange="calcularDividaTotal()">
                    </div>

                    <h3>Cheque Especial</h3>
                     <div class="form-group">
                        <label>Com que frequência você utiliza o limite do cheque especial?</label>
                        <select id="chequeEspecialFrequencia" name="chequeEspecialFrequencia">
                            <option value="nunca" selected>Nunca</option>
                            <option value="raramente">Raramente (emergências)</option>
                            <option value="as_vezes">Às vezes</option>
                            <option value="frequentemente">Frequentemente</option>
                        </select>
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(6, 5)">Anterior</button>
                    <button type="button" onclick="nextTab(6, 7)">Próximo</button>
                </div>
            </div>

            <div id="tab7" class="tab">
                <!-- 8. Patrimônio Líquido -->
                <fieldset>
                    <legend>Patrimônio Líquido (Investimentos e Aplicações)</legend>
                    <h3>Investimentos</h3>
                    <div class="form-group">
                        <label for="invRendaFixa">Valor total em Renda Fixa (CDB, LCI/LCA, Tesouro Direto, etc.) (R$):</label>
                        <input type="number" id="invRendaFixa" name="invRendaFixa" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>
                    <div class="form-group">
                        <label for="invRendaVariavel">Valor total em Renda Variável (Ações, FIIs, ETFs, etc.) (R$):</label>
                        <input type="number" id="invRendaVariavel" name="invRendaVariavel" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>
                    <div class="form-group">
                        <label for="invFundos">Valor total em Fundos de Investimento (Multimercado, Ações, Renda Fixa) (R$):</label>
                        <input type="number" id="invFundos" name="invFundos" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>

                    <h3>Aplicações Financeiras</h3>
                    <div class="form-group">
                        <label for="appPoupanca">Valor total em Caderneta de Poupança (R$):</label>
                        <input type="number" id="appPoupanca" name="appPoupanca" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>
                    <div class="form-group">
                        <label for="appPrevidencia">Valor total acumulado em Previdência Privada (PGBL/VGBL) (R$):</label>
                        <input type="number" id="appPrevidencia" name="appPrevidencia" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>

                    <h3>Outros Ativos Líquidos</h3>
                     <div class="form-group">
                        <label for="partNegocios">Valor estimado de participações em negócios (R$):</label>
                        <input type="number" id="partNegocios" name="partNegocios" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>
                    <div class="form-group">
                        <label for="outrosLiquidos">Outros ativos com liquidez (Ex: Criptomoedas, saldo em conta) (R$):</label>
                        <input type="number" id="outrosLiquidos" name="outrosLiquidos" min="0" step="0.01" placeholder="0.00" onchange="calcularPatrimonioTotal()">
                    </div>

                    <h3>Capacidade de Poupança</h3>
                    <div class="form-group">
                        <label for="poupancaMensal">Quanto você consegue poupar/investir em média por mês (R$)?</label>
                        <input type="number" id="poupancaMensal" name="poupancaMensal" min="0" step="0.01" placeholder="0.00">
                    </div>
                     <div class="form-group">
                        <label>Com que regularidade você consegue poupar/investir?</label>
                        <select id="poupancaRegularidade" name="poupancaRegularidade">
                            <option value="regularmente" selected>Regularmente (todo mês)</option>
                            <option value="as_vezes">Às vezes (quando sobra)</option>
                            <option value="raramente">Raramente</option>
                            <option value="nunca">Nunca</option>
                        </select>
                    </div>
                     <div class="form-group">
                        <label for="reservaEmergencia">Você possui uma reserva de emergência (equivalente a quantos meses de custo de vida)?</label>
                        <input type="number" id="reservaEmergencia" name="reservaEmergencia" min="0" step="0.5" placeholder="Ex: 6">
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(7, 6)">Anterior</button>
                    <button type="button" onclick="nextTab(7, 8)">Próximo</button>
                </div>
            </div>

            <div id="tab8" class="tab">
                <!-- 9. Gestão de Risco -->
                <fieldset>
                    <legend>Gestão de Risco (Seguros e Proteção)</legend>
                    <div class="form-group">
                        <label>Possui Seguro de Vida? <span class="tooltip">?<span class="tooltiptext">O seguro de vida garante proteção financeira para seus dependentes em caso de falecimento ou invalidez.</span></span></label>
                        <div class="radio-group">
                            <label><input type="radio" name="seguroVida" value="sim" onclick="toggleCobertura('seguroVidaCobertura', true)"> Sim</label>
                            <label><input type="radio" name="seguroVida" value="nao" checked onclick="toggleCobertura('seguroVidaCobertura', false)"> Não</label>
                        </div>
                        <input type="number" id="seguroVidaCobertura" name="seguroVidaCobertura" placeholder="Valor da Cobertura (R$)" style="display: none; margin-top: 10px;">
                    </div>
                    <div class="form-group">
                        <label>Possui Plano de Saúde? <span class="tooltip">?<span class="tooltiptext">O plano de saúde oferece cobertura para despesas médicas e hospitalares, reduzindo impactos financeiros em caso de problemas de saúde.</span></span></label>
                        <div class="radio-group">
                            <label><input type="radio" name="planoSaude" value="sim" onclick="toggleCobertura('planoSaudeTipo', true)"> Sim</label>
                            <label><input type="radio" name="planoSaude" value="nao" checked onclick="toggleCobertura('planoSaudeTipo', false)"> Não</label>
                        </div>
                        <input type="text" id="planoSaudeTipo" name="planoSaudeTipo" placeholder="Tipo (Ex: Empresarial, Individual, Cobertura)" style="display: none; margin-top: 10px;">
                    </div>
                    <div class="form-group">
                        <label>Possui Plano Odontológico?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="planoOdonto" value="sim"> Sim</label>
                            <label><input type="radio" name="planoOdonto" value="nao" checked> Não</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Possui Plano Pet?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="planoPet" value="sim"> Sim</label>
                            <label><input type="radio" name="planoPet" value="nao" checked> Não</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Possui Seguro de Responsabilidade Civil Profissional? <span class="tooltip">?<span class="tooltiptext">Protege contra danos causados a terceiros no exercício da sua profissão.</span></span></label>
                        <div class="radio-group">
                            <label><input type="radio" name="seguroRC" value="sim"> Sim</label>
                            <label><input type="radio" name="seguroRC" value="nao" checked> Não</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Possui Seguro de Automóvel?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="seguroAuto" value="sim"> Sim</label>
                            <label><input type="radio" name="seguroAuto" value="nao" checked> Não</label>
                            <label><input type="radio" name="seguroAuto" value="nao_aplica"> Não se aplica</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Possui Seguro Residencial/Imóvel? <span class="tooltip">?<span class="tooltiptext">Protege seu imóvel contra incêndio, roubo, danos elétricos e outros riscos.</span></span></label>
                        <div class="radio-group">
                            <label><input type="radio" name="seguroImovel" value="sim"> Sim</label>
                            <label><input type="radio" name="seguroImovel" value="nao" checked> Não</label>
                             <label><input type="radio" name="seguroImovel" value="nao_aplica"> Não se aplica</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="outrosSeguros">Possui outros seguros relevantes?</label>
                        <textarea id="outrosSeguros" name="outrosSeguros" placeholder="Ex: Seguro viagem, Seguro para equipamentos..."></textarea>
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(8, 7)">Anterior</button>
                    <button type="button" onclick="nextTab(8, 9)">Próximo</button>
                </div>
            </div>

            <div id="tab9" class="tab">
                <!-- 10. Aposentadoria -->
                <fieldset>
                    <legend>Planejamento de Aposentadoria</legend>
                    <div class="form-group">
                        <label for="aposentadoriaRegime">Qual seu regime de previdência principal?</label>
                        <select id="aposentadoriaRegime" name="aposentadoriaRegime">
                            <option value="inss">INSS (Regime Geral)</option>
                            <option value="rpps">RPPS (Regime Próprio - Servidor Público)</option>
                            <option value="nenhum">Nenhum / Autônomo sem contribuição</option>
                            <option value="outro">Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="aposentadoriaContribuicaoTempo">Tempo total de contribuição estimado (em anos):</label>
                        <input type="number" id="aposentadoriaContribuicaoTempo" name="aposentadoriaContribuicaoTempo" min="0">
                    </div>
                    <div class="form-group">
                        <label for="aposentadoriaExpectativaINSS">Qual sua expectativa de valor do benefício do INSS/RPPS (R$ mensais)?</label>
                        <input type="number" id="aposentadoriaExpectativaINSS" name="aposentadoriaExpectativaINSS" min="0" step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Você contribui para Previdência Complementar?</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="prevComp" value="pgbl"> PGBL</label>
                            <label><input type="checkbox" name="prevComp" value="vgbl"> VGBL</label>
                            <label><input type="checkbox" name="prevComp" value="fundo_pensao"> Fundo de Pensão (Previdência Fechada)</label>
                            <label><input type="checkbox" name="prevComp" value="nenhum"> Nenhum</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="aposentadoriaInvestimentos">Você possui outros investimentos específicos para aposentadoria?</label>
                        <textarea id="aposentadoriaInvestimentos" name="aposentadoriaInvestimentos" placeholder="Ex: Ações focadas em dividendos, Fundos de longo prazo..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="aposentadoriaIdadeDesejada">Com que idade você planeja se aposentar?</label>
                        <input type="number" id="aposentadoriaIdadeDesejada" name="aposentadoriaIdadeDesejada" min="0">
                    </div>
                    <div class="form-group">
                        <label for="aposentadoriaRendaDesejada">Qual a renda mensal que você deseja ter na aposentadoria (em valores de hoje, R$)?</label>
                        <input type="number" id="aposentadoriaRendaDesejada" name="aposentadoriaRendaDesejada" min="0" step="0.01" placeholder="0.00">
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(9, 8)">Anterior</button>
                    <button type="button" onclick="nextTab(9, 10)">Próximo</button>
                </div>
            </div>

            <div id="tab10" class="tab">
                <!-- 11. Planejamento Tributário -->
                <fieldset>
                    <legend>Planejamento Tributário (IRPF)</legend>
                    <div class="form-group">
                        <label>Qual modelo de declaração do Imposto de Renda Pessoa Física você costuma utilizar?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="irpfModelo" value="simplificada"> Simplificada</label>
                            <label><input type="radio" name="irpfModelo" value="completa"> Completa (por deduções legais)</label>
                            <label><input type="radio" name="irpfModelo" value="isento"> Isento / Não declaro</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Quais deduções você costuma utilizar na declaração completa?</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="irpfDeducoes" value="medicas"> Despesas Médicas</label><br>
                            <label><input type="checkbox" name="irpfDeducoes" value="educacao"> Despesas com Educação</label><br>
                            <label><input type="checkbox" name="irpfDeducoes" value="dependentes"> Dependentes</label><br>
                            <label><input type="checkbox" name="irpfDeducoes" value="previdencia_privada"> Previdência Privada (PGBL)</label><br>
                            <label><input type="checkbox" name="irpfDeducoes" value="pensao_alimenticia"> Pensão Alimentícia</label><br>
                            <label><input type="checkbox" name="irpfDeducoes" value="doacoes"> Doações Incentivadas</label><br>
                            <label><input type="checkbox" name="irpfDeducoes" value="livro_caixa"> Livro Caixa (autônomos)</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="irpfObservacoes">Observações sobre seu planejamento tributário ou dúvidas:</label>
                        <textarea id="irpfObservacoes" name="irpfObservacoes"></textarea>
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(10, 9)">Anterior</button>
                    <button type="button" onclick="nextTab(10, 11)">Próximo</button>
                </div>
            </div>

            <div id="tab11" class="tab">
                <!-- 12. Planejamento Sucessório -->
                <fieldset>
                    <legend>Planejamento Sucessório</legend>
                     <div class="form-group">
                        <label>Você possui testamento? <span class="tooltip">?<span class="tooltiptext">O testamento permite definir como seus bens serão distribuídos após seu falecimento, respeitando a parte legítima dos herdeiros necessários.</span></span></label>
                        <div class="radio-group">
                            <label><input type="radio" name="sucessaoTestamento" value="sim"> Sim</label>
                            <label><input type="radio" name="sucessaoTestamento" value="nao" checked> Não</label>
                            <label><input type="radio" name="sucessaoTestamento" value="pensando"> Estou pensando em fazer</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label>Você já realizou ou planeja realizar doações em vida como parte do planejamento?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="sucessaoDoacoes" value="sim"> Sim</label>
                            <label><input type="radio" name="sucessaoDoacoes" value="nao" checked> Não</label>
                            <label><input type="radio" name="sucessaoDoacoes" value="planeja"> Planejo fazer</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label>Você tem conhecimento sobre o processo de inventário?</label>
                         <div class="radio-group">
                            <label><input type="radio" name="sucessaoInventario" value="sim"> Sim</label>
                            <label><input type="radio" name="sucessaoInventario" value="nao" checked> Não</label>
                            <label><input type="radio" name="sucessaoInventario" value="pouco"> Pouco</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label>Você utiliza ou considera utilizar algum destes instrumentos para sucessão?</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="sucessaoInstrumentos" value="seguro_vida"> Seguro de Vida</label><br>
                            <label><input type="checkbox" name="sucessaoInstrumentos" value="previdencia_privada"> Previdência Privada</label><br>
                            <label><input type="checkbox" name="sucessaoInstrumentos" value="holding"> Holding Familiar</label><br>
                            <label><input type="checkbox" name="sucessaoInstrumentos" value="doacao_usufruto"> Doação com reserva de usufruto</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="sucessaoObservacoes">Observações ou preocupações sobre planejamento sucessório:</label>
                        <textarea id="sucessaoObservacoes" name="sucessaoObservacoes"></textarea>
                    </div>
                </fieldset>
                
                <div class="tab-buttons">
                    <button type="button" onclick="prevTab(11, 10)">Anterior</button>
                    <button type="button" onclick="gerarAnalise()">Gerar Análise</button>
                </div>
            </div>
        </form>

        <!-- Seção de Análise (será preenchida via JS) -->
        <div id="secaoAnalise" class="analysis-section" style="display: none;">
            <h2>Análise do Diagnóstico</h2>
            
            <div class="result-card">
                <h3>Resumo Financeiro</h3>
                <div id="resumoFinanceiro">
                    <p><strong>Patrimônio Total:</strong> <span id="patrimonioTotal">R$ 0,00</span></p>
                    <p><strong>Dívidas Totais:</strong> <span id="dividaTotal">R$ 0,00</span></p>
                    <p><strong>Patrimônio Líquido:</strong> <span id="patrimonioLiquido">R$ 0,00</span></p>
                    <p><strong>Saldo Mensal:</strong> <span id="saldoMensalResumo">R$ 0,00</span></p>
                    <p><strong>Índice de Endividamento:</strong> <span id="indiceEndividamento">0%</span></p>
                    <p><strong>Índice de Poupança:</strong> <span id="indicePoupanca">0%</span></p>
                </div>
            </div>

            <div class="result-card">
                <h3>Seu Perfil Financeiro</h3>
                <p id="perfilCalculado">Preencha o formulário para ver seu perfil.</p>
                <div class="form-group">
                    <label for="perfilEditavel">Edite seu perfil se necessário:</label>
                    <select id="perfilEditavel" name="perfilEditavel">
                        <option value="">Selecione...</option>
                        <option value="DIVIDAS IMPAGAVEIS">DÍVIDAS IMPAGÁVEIS</option>
                        <option value="DIVIDAS PAGAVEIS">DÍVIDAS PAGÁVEIS</option>
                        <option value="ZERO A ZERO OBRIGATORIO">ZERO A ZERO OBRIGATÓRIO</option>
                        <option value="ZERO A ZERO OPCIONAL">ZERO A ZERO OPCIONAL</option>
                        <option value="FLUXO POSITIVO">FLUXO POSITIVO</option>
                        <option value="POUPADOR">POUPADOR</option>
                        <option value="INVESTIDOR AMADOR">INVESTIDOR AMADOR</option>
                        <option value="INVESTIDOR PLANEJADOR">INVESTIDOR PLANEJADOR</option>
                    </select>
                </div>
            </div>

            <div class="result-card">
                <h3>Principais Pontos de Atenção (Negativos)</h3>
                <p id="pontosNegativosCalculados">Preencha o formulário para ver os pontos de atenção.</p>
                <div class="form-group">
                    <label for="pontosNegativosEditavel">Edite a análise de pontos negativos se necessário:</label>
                    <textarea id="pontosNegativosEditavel" class="editable-textarea"></textarea>
                </div>
            </div>
            
            <div class="result-card">
                <h3>Recomendações</h3>
                <p id="recomendacoesCalculadas">Preencha o formulário para ver as recomendações.</p>
            </div>
            
            <div class="button-container">
                <button type="button" onclick="voltarAoFormulario()">Voltar ao Formulário</button>
                <button type="button" class="secondary" onclick="gerarPDF()">Gerar PDF</button>
            </div>
        </div>

    </div>

    <script>
        // Variáveis globais para armazenar os cálculos
        let patrimonioTotal = 0;
        let dividaTotal = 0;
        let patrimonioLiquido = 0;
        let saldoMensal = 0;
        let indiceEndividamento = 0;
        let indicePoupanca = 0;
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Mostrar a primeira aba
            document.getElementById('tab1').classList.add('active');
            atualizarProgressBar(1);
            
            // Configurar eventos para campos específicos
            document.getElementById('periodoAnalise').addEventListener('change', function() {
                const periodoPersonalizado = document.getElementById('periodoPersonalizado');
                periodoPersonalizado.style.display = this.value === 'personalizado' ? 'block' : 'none';
            });
        });
        
        // Navegação entre abas
        function nextTab(currentTab, nextTab) {
            document.getElementById('tab' + currentTab).classList.remove('active');
            document.getElementById('tab' + nextTab).classList.add('active');
            atualizarProgressBar(nextTab);
            window.scrollTo(0, 0);
        }
        
        function prevTab(currentTab, prevTab) {
            document.getElementById('tab' + currentTab).classList.remove('active');
            document.getElementById('tab' + prevTab).classList.add('active');
            atualizarProgressBar(prevTab);
            window.scrollTo(0, 0);
        }
        
        function atualizarProgressBar(tabAtual) {
            const totalTabs = 11; // Total de abas no formulário
            const progresso = (tabAtual / totalTabs) * 100;
            document.getElementById('progress').style.width = progresso + '%';
        }
        
        // Mostrar/esconder campos de cobertura
        function toggleCobertura(id, mostrar) {
            document.getElementById(id).style.display = mostrar ? 'block' : 'none';
        }
        
        // Cálculos financeiros
        function calcularSaldo() {
            // Receitas
            const salario = parseFloat(document.getElementById('receitaSalario').value) || 0;
            const alugueis = parseFloat(document.getElementById('receitaAlugueis').value) || 0;
            const dividendos = parseFloat(document.getElementById('receitaDividendos').value) || 0;
            const outrasReceitas = parseFloat(document.getElementById('receitaOutras').value) || 0;
            
            // Despesas Fixas
            const moradia = parseFloat(document.getElementById('despesaMoradia').value) || 0;
            const educacao = parseFloat(document.getElementById('despesaEducacao').value) || 0;
            const saude = parseFloat(document.getElementById('despesaSaude').value) || 0;
            const transporte = parseFloat(document.getElementById('despesaTransporte').value) || 0;
            const alimentacao = parseFloat(document.getElementById('despesaAlimentacaoFixa').value) || 0;
            const servicosBasicos = parseFloat(document.getElementById('despesaServicosBasicos').value) || 0;
            const outrasFixas = parseFloat(document.getElementById('despesaOutrasFixas').value) || 0;
            
            // Despesas Variáveis
            const lazer = parseFloat(document.getElementById('despesaLazer').value) || 0;
            const vestuario = parseFloat(document.getElementById('despesaVestuario').value) || 0;
            const presentes = parseFloat(document.getElementById('despesaPresentes').value) || 0;
            const viagens = parseFloat(document.getElementById('despesaViagens').value) || 0;
            const outrasVariaveis = parseFloat(document.getElementById('despesaOutrasVariaveis').value) || 0;
            
            // Cálculo do saldo
            const totalReceitas = salario + alugueis + dividendos + outrasReceitas;
            const totalDespesasFixas = moradia + educacao + saude + transporte + alimentacao + servicosBasicos + outrasFixas;
            const totalDespesasVariaveis = lazer + vestuario + presentes + viagens + outrasVariaveis;
            
            saldoMensal = totalReceitas - totalDespesasFixas - totalDespesasVariaveis;
            
            // Formatação e exibição
            const formatoMoeda = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' });
            document.getElementById('saldoMensal').value = formatoMoeda.format(saldoMensal);
            
            // Atualizar índice de poupança se o campo de poupança mensal estiver preenchido
            const poupancaMensal = parseFloat(document.getElementById('poupancaMensal').value) || 0;
            if (totalReceitas > 0 && poupancaMensal > 0) {
                indicePoupanca = (poupancaMensal / totalReceitas) * 100;
            }
            
            return saldoMensal;
        }
        
        function calcularPatrimonioTotal() {
            // Patrimônio Físico
            const imoveis = parseFloat(document.getElementById('imoveisValor').value) || 0;
            const veiculos = parseFloat(document.getElementById('veiculosValor').value) || 0;
            const outrosBens = parseFloat(document.getElementById('outrosBensValor').value) || 0;
            
            // Investimentos e Aplicações
            const rendaFixa = parseFloat(document.getElementById('invRendaFixa').value) || 0;
            const rendaVariavel = parseFloat(document.getElementById('invRendaVariavel').value) || 0;
            const fundos = parseFloat(document.getElementById('invFundos').value) || 0;
            const poupanca = parseFloat(document.getElementById('appPoupanca').value) || 0;
            const previdencia = parseFloat(document.getElementById('appPrevidencia').value) || 0;
            const negocios = parseFloat(document.getElementById('partNegocios').value) || 0;
            const outrosLiquidos = parseFloat(document.getElementById('outrosLiquidos').value) || 0;
            
            patrimonioTotal = imoveis + veiculos + outrosBens + rendaFixa + rendaVariavel + 
                             fundos + poupanca + previdencia + negocios + outrosLiquidos;
            
            calcularPatrimonioLiquido();
            return patrimonioTotal;
        }
        
        function calcularDividaTotal() {
            const financiamentos = parseFloat(document.getElementById('financiamentoSaldo').value) || 0;
            const emprestimos = parseFloat(document.getElementById('emprestimoSaldo').value) || 0;
            const cartaoRotativo = parseFloat(document.getElementById('cartaoSaldoRotativo').value) || 0;
            
            dividaTotal = financiamentos + emprestimos + cartaoRotativo;
            
            // Calcular índice de endividamento se houver receita
            const salario = parseFloat(document.getElementById('receitaSalario').value) || 0;
            const alugueis = parseFloat(document.getElementById('receitaAlugueis').value) || 0;
            const dividendos = parseFloat(document.getElementById('receitaDividendos').value) || 0;
            const outrasReceitas = parseFloat(document.getElementById('receitaOutras').value) || 0;
            
            const totalReceitas = salario + alugueis + dividendos + outrasReceitas;
            
            if (totalReceitas > 0) {
                // Parcelas mensais
                const parcelaFinanciamento = parseFloat(document.getElementById('financiamentoParcela').value) || 0;
                const parcelaEmprestimo = parseFloat(document.getElementById('emprestimoParcela').value) || 0;
                
                const totalParcelas = parcelaFinanciamento + parcelaEmprestimo;
                indiceEndividamento = (totalParcelas / totalReceitas) * 100;
            }
            
            calcularPatrimonioLiquido();
            return dividaTotal;
        }
        
        function calcularPatrimonioLiquido() {
            patrimonioLiquido = patrimonioTotal - dividaTotal;
            return patrimonioLiquido;
        }
        
        // Análise do perfil financeiro
        function determinarPerfilFinanceiro() {
            // Verificar se há dados suficientes
            if (patrimonioTotal === 0 && dividaTotal === 0 && saldoMensal === 0) {
                return "DADOS INSUFICIENTES";
            }
            
            // Verificar se há dívidas impagáveis
            if (indiceEndividamento > 50 || (dividaTotal > 0 && saldoMensal <= 0)) {
                return "DÍVIDAS IMPAGÁVEIS";
            }
            
            // Verificar se há dívidas pagáveis
            if (dividaTotal > 0 && indiceEndividamento > 30 && indiceEndividamento <= 50) {
                return "DÍVIDAS PAGÁVEIS";
            }
            
            // Verificar se está no zero a zero
            if (saldoMensal === 0 || Math.abs(saldoMensal) < 0.05 * patrimonioTotal) {
                if (dividaTotal > 0) {
                    return "ZERO A ZERO OBRIGATÓRIO";
                } else {
                    return "ZERO A ZERO OPCIONAL";
                }
            }
            
            // Verificar fluxo positivo
            if (saldoMensal > 0 && indicePoupanca < 10) {
                return "FLUXO POSITIVO";
            }
            
            // Verificar poupador
            if (indicePoupanca >= 10 && indicePoupanca < 20) {
                return "POUPADOR";
            }
            
            // Verificar investidor amador
            const rendaVariavel = parseFloat(document.getElementById('invRendaVariavel').value) || 0;
            const fundos = parseFloat(document.getElementById('invFundos').value) || 0;
            const investimentosDiversificados = rendaVariavel + fundos;
            
            if (indicePoupanca >= 20 && investimentosDiversificados < 0.3 * patrimonioTotal) {
                return "INVESTIDOR AMADOR";
            }
            
            // Verificar investidor planejador
            if (indicePoupanca >= 20 && investimentosDiversificados >= 0.3 * patrimonioTotal) {
                return "INVESTIDOR PLANEJADOR";
            }
            
            // Caso padrão
            return "FLUXO POSITIVO";
        }
        
        // Identificar pontos negativos
        function identificarPontosNegativos() {
            const pontosNegativos = [];
            
            // Verificar saldo mensal negativo
            if (saldoMensal < 0) {
                pontosNegativos.push("Saldo mensal negativo: suas despesas superam suas receitas.");
            }
            
            // Verificar alto índice de endividamento
            if (indiceEndividamento > 30) {
                pontosNegativos.push(`Índice de endividamento elevado (${indiceEndividamento.toFixed(2)}%): o recomendado é manter abaixo de 30% da renda.`);
            }
            
            // Verificar uso de cartão de crédito rotativo
            const cartaoRotativo = parseFloat(document.getElementById('cartaoSaldoRotativo').value) || 0;
            if (cartaoRotativo > 0) {
                pontosNegativos.push("Uso do rotativo do cartão de crédito, que possui taxas de juros extremamente elevadas.");
            }
            
            // Verificar uso frequente de cheque especial
            const chequeEspecial = document.getElementById('chequeEspecialFrequencia').value;
            if (chequeEspecial === 'frequentemente' || chequeEspecial === 'as_vezes') {
                pontosNegativos.push("Uso frequente do cheque especial, que possui taxas de juros elevadas.");
            }
            
            // Verificar ausência de reserva de emergência
            const reservaEmergencia = parseFloat(document.getElementById('reservaEmergencia').value) || 0;
            if (reservaEmergencia < 3) {
                pontosNegativos.push("Reserva de emergência insuficiente: o recomendado é ter pelo menos 3 a 6 meses de despesas guardados.");
            }
            
            // Verificar ausência de seguros essenciais
            const seguroVida = document.querySelector('input[name="seguroVida"]:checked')?.value;
            const planoSaude = document.querySelector('input[name="planoSaude"]:checked')?.value;
            const seguroImovel = document.querySelector('input[name="seguroImovel"]:checked')?.value;
            const seguroAuto = document.querySelector('input[name="seguroAuto"]:checked')?.value;
            
            const dependentes = parseInt(document.getElementById('dependentes').value) || 0;
            if (dependentes > 0 && seguroVida === 'nao') {
                pontosNegativos.push("Ausência de seguro de vida, apesar de possuir dependentes.");
            }
            
            if (planoSaude === 'nao') {
                pontosNegativos.push("Ausência de plano de saúde, o que pode gerar impactos financeiros significativos em caso de problemas de saúde.");
            }
            
            const imoveis = parseFloat(document.getElementById('imoveisValor').value) || 0;
            if (imoveis > 0 && seguroImovel === 'nao') {
                pontosNegativos.push("Ausência de seguro residencial/imóvel para proteger seu patrimônio.");
            }
            
            const veiculos = parseFloat(document.getElementById('veiculosValor').value) || 0;
            if (veiculos > 0 && seguroAuto === 'nao') {
                pontosNegativos.push("Ausência de seguro de automóvel para proteger seu veículo.");
            }
            
            // Verificar planejamento para aposentadoria
            const previdencia = document.querySelectorAll('input[name="prevComp"]:checked');
            const aposentadoriaInvestimentos = document.getElementById('aposentadoriaInvestimentos').value;
            
            if (previdencia.length === 0 || (previdencia.length === 1 && previdencia[0].value === 'nenhum')) {
                if (!aposentadoriaInvestimentos || aposentadoriaInvestimentos.trim() === '') {
                    pontosNegativos.push("Ausência de planejamento para aposentadoria, seja via previdência complementar ou investimentos específicos.");
                }
            }
            
            // Verificar planejamento sucessório
            const testamento = document.querySelector('input[name="sucessaoTestamento"]:checked')?.value;
            const sucessaoInstrumentos = document.querySelectorAll('input[name="sucessaoInstrumentos"]:checked');
            
            if ((testamento === 'nao' || testamento === 'pensando') && sucessaoInstrumentos.length === 0) {
                pontosNegativos.push("Ausência de planejamento sucessório, o que pode gerar complicações e custos adicionais para seus herdeiros.");
            }
            
            // Verificar diversificação de investimentos
            const rendaFixa = parseFloat(document.getElementById('invRendaFixa').value) || 0;
            const rendaVariavel = parseFloat(document.getElementById('invRendaVariavel').value) || 0;
            const fundos = parseFloat(document.getElementById('invFundos').value) || 0;
            const poupanca = parseFloat(document.getElementById('appPoupanca').value) || 0;
            
            const totalInvestimentos = rendaFixa + rendaVariavel + fundos + poupanca;
            
            if (totalInvestimentos > 0) {
                if (poupanca > 0.5 * totalInvestimentos) {
                    pontosNegativos.push("Concentração excessiva em caderneta de poupança, que geralmente oferece retornos abaixo da inflação.");
                }
                
                if (rendaVariavel === 0 && fundos === 0) {
                    pontosNegativos.push("Ausência de investimentos em renda variável ou fundos diversificados, o que pode limitar o potencial de rentabilidade no longo prazo.");
                }
            }
            
            return pontosNegativos.length > 0 ? pontosNegativos : ["Nenhum ponto negativo crítico identificado."];
        }
        
        // Gerar recomendações
        function gerarRecomendacoes() {
            const recomendacoes = [];
            const perfil = determinarPerfilFinanceiro();
            
            // Recomendações baseadas no perfil
            switch(perfil) {
                case "DÍVIDAS IMPAGÁVEIS":
                    recomendacoes.push("Priorize a renegociação de dívidas com taxas de juros mais altas.");
                    recomendacoes.push("Considere a possibilidade de consolidação de dívidas para reduzir as taxas de juros.");
                    recomendacoes.push("Reduza drasticamente despesas não essenciais para aumentar o saldo mensal.");
                    recomendacoes.push("Busque fontes adicionais de renda temporárias para acelerar o pagamento de dívidas.");
                    break;
                    
                case "DÍVIDAS PAGÁVEIS":
                    recomendacoes.push("Crie um plano de amortização de dívidas, priorizando as com maiores taxas de juros.");
                    recomendacoes.push("Evite contrair novas dívidas até quitar as existentes.");
                    recomendacoes.push("Reavalie seu orçamento para aumentar o valor destinado ao pagamento de dívidas.");
                    break;
                    
                case "ZERO A ZERO OBRIGATÓRIO":
                case "ZERO A ZERO OPCIONAL":
                    recomendacoes.push("Identifique despesas que podem ser reduzidas para criar uma margem de poupança.");
                    recomendacoes.push("Estabeleça metas de economia mensais, mesmo que pequenas inicialmente.");
                    recomendacoes.push("Considere fontes adicionais de renda para aumentar seu fluxo de caixa.");
                    break;
                    
                case "FLUXO POSITIVO":
                    recomendacoes.push("Estabeleça uma meta de poupança mensal de pelo menos 10% da sua renda.");
                    recomendacoes.push("Crie uma reserva de emergência equivalente a 3-6 meses de despesas.");
                    recomendacoes.push("Após constituir a reserva, comece a investir regularmente em produtos adequados ao seu perfil.");
                    break;
                    
                case "POUPADOR":
                    recomendacoes.push("Diversifique seus investimentos para além da poupança, buscando melhor rentabilidade.");
                    recomendacoes.push("Considere investimentos em renda fixa com melhor retorno, como Tesouro Direto e CDBs.");
                    recomendacoes.push("Busque educação financeira para entender melhor as opções de investimento disponíveis.");
                    break;
                    
                case "INVESTIDOR AMADOR":
                    recomendacoes.push("Diversifique ainda mais sua carteira de investimentos, incluindo diferentes classes de ativos.");
                    recomendacoes.push("Considere uma alocação estratégica baseada em seus objetivos de longo prazo.");
                    recomendacoes.push("Avalie a contratação de um planejador financeiro certificado para otimizar sua estratégia.");
                    break;
                    
                case "INVESTIDOR PLANEJADOR":
                    recomendacoes.push("Continue com a estratégia de diversificação e investimento regular.");
                    recomendacoes.push("Revise periodicamente sua alocação de ativos para garantir alinhamento com seus objetivos.");
                    recomendacoes.push("Considere estratégias mais sofisticadas de planejamento tributário e sucessório.");
                    break;
                    
                default:
                    recomendacoes.push("Estabeleça objetivos financeiros claros e mensuráveis.");
                    recomendacoes.push("Crie um orçamento detalhado para acompanhar receitas e despesas.");
                    recomendacoes.push("Constitua uma reserva de emergência antes de iniciar investimentos de maior risco.");
            }
            
            // Recomendações específicas baseadas nos pontos negativos
            const pontosNegativos = identificarPontosNegativos();
            
            if (pontosNegativos.includes("Saldo mensal negativo: suas despesas superam suas receitas.")) {
                recomendacoes.push("Revise seu orçamento identificando despesas que podem ser reduzidas ou eliminadas.");
                recomendacoes.push("Considere renegociar dívidas para reduzir o valor das parcelas mensais.");
            }
            
            if (pontosNegativos.some(ponto => ponto.includes("Índice de endividamento elevado"))) {
                recomendacoes.push("Evite contrair novas dívidas até reduzir seu índice de endividamento para menos de 30% da renda.");
                recomendacoes.push("Considere a portabilidade de dívidas para instituições com taxas de juros mais baixas.");
            }
            
            if (pontosNegativos.includes("Uso do rotativo do cartão de crédito, que possui taxas de juros extremamente elevadas.")) {
                recomendacoes.push("Priorize o pagamento do saldo devedor do cartão de crédito, mesmo que isso signifique reduzir temporariamente outros investimentos.");
                recomendacoes.push("Considere um empréstimo pessoal com taxa de juros menor para quitar o rotativo do cartão.");
            }
            
            if (pontosNegativos.includes("Reserva de emergência insuficiente: o recomendado é ter pelo menos 3 a 6 meses de despesas guardados.")) {
                recomendacoes.push("Estabeleça como prioridade a constituição de uma reserva de emergência em investimentos de alta liquidez.");
                recomendacoes.push("Destine uma porcentagem fixa da sua renda mensal para a reserva de emergência até atingir o valor ideal.");
            }
            
            // Remover duplicatas
            return [...new Set(recomendacoes)];
        }
        
        // Gerar análise completa
        function gerarAnalise() {
            // Calcular todos os indicadores
            calcularSaldo();
            calcularPatrimonioTotal();
            calcularDividaTotal();
            
            // Determinar perfil financeiro
            const perfil = determinarPerfilFinanceiro();
            document.getElementById('perfilCalculado').innerText = perfil;
            document.getElementById('perfilEditavel').value = perfil;
            
            // Identificar pontos negativos
            const pontosNegativos = identificarPontosNegativos();
            document.getElementById('pontosNegativosCalculados').innerHTML = pontosNegativos.map(ponto => `• ${ponto}`).join('<br>');
            document.getElementById('pontosNegativosEditavel').value = pontosNegativos.map(ponto => `• ${ponto}`).join('\n');
            
            // Gerar recomendações
            const recomendacoes = gerarRecomendacoes();
            document.getElementById('recomendacoesCalculadas').innerHTML = recomendacoes.map(rec => `• ${rec}`).join('<br>');
            
            // Atualizar resumo financeiro
            const formatoMoeda = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' });
            document.getElementById('patrimonioTotal').innerText = formatoMoeda.format(patrimonioTotal);
            document.getElementById('dividaTotal').innerText = formatoMoeda.format(dividaTotal);
            document.getElementById('patrimonioLiquido').innerText = formatoMoeda.format(patrimonioLiquido);
            document.getElementById('saldoMensalResumo').innerText = formatoMoeda.format(saldoMensal);
            document.getElementById('indiceEndividamento').innerText = indiceEndividamento.toFixed(2) + '%';
            document.getElementById('indicePoupanca').innerText = indicePoupanca.toFixed(2) + '%';
            
            // Mostrar seção de análise
            document.getElementById('secaoAnalise').style.display = 'block';
            
            // Esconder todas as abas do formulário
            for (let i = 1; i <= 11; i++) {
                document.getElementById('tab' + i).classList.remove('active');
            }
            
            // Scroll para a seção de análise
            document.getElementById('secaoAnalise').scrollIntoView({ behavior: 'smooth' });
        }
        
        function voltarAoFormulario() {
            // Esconder seção de análise
            document.getElementById('secaoAnalise').style.display = 'none';
            
            // Mostrar primeira aba do formulário
            document.getElementById('tab1').classList.add('active');
            atualizarProgressBar(1);
            
            // Scroll para o topo
            window.scrollTo(0, 0);
        }
        
        function gerarPDF() {
            alert("Para gerar o PDF do seu diagnóstico financeiro, você precisará de uma biblioteca como jsPDF ou html2pdf.js. Em um ambiente de produção, esta funcionalidade estaria implementada para permitir o download do relatório completo.");
            
            // Em uma implementação real, usaríamos código como este:
            /*
            import { jsPDF } from "jspdf";
            import html2canvas from "html2canvas";
            
            // Capturar o conteúdo da análise
            const element = document.getElementById('secaoAnalise');
            
            html2canvas(element).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgProps = pdf.getImageProperties(imgData);
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
                
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save('diagnostico_financeiro.pdf');
            });
            */
        }
    </script>

</body>
</html>
